{#- Navigation component matching otherdev.com design -#}

{#- Define navigation links -#}
{%- set navLinks = [
  { title: "Home", path: "/" },
  { title: "Archive", path: "/blog/" },
  { title: "About", path: "/about/" },
  { title: "Feed", path: "/feed/feed.xml", target: "_blank" }
] -%}

{#- Action links -#}
{%- set letsMeetLink = {
  title: "Let's meet",
  path: "https://calendly.com/otherdev/30-minute-consultation-call-1",
  target: "_blank"
} -%}

{#- Social links -#}
{%- set socialLinks = [
  {
    title: "LinkedIn", 
    path: "https://www.linkedin.com/company/theotherdev/"
  },
  {
    title: "Instagram",
    path: "https://instagram.com/other.dev"
  }
] -%}

{#- Mobile Navigation -#}
<nav aria-label="Mobile Navigation" class="text-[var(--color-stone-400-inverted)] lg:hidden flex justify-between header-blend-mode items-center w-full px-4 pt-4 text-sm fixed top-0 z-50">
  <div>
    <a href="/" class="w-full flex-1/2 font-queens text-lg" aria-label="The Other Dev Home">{{ metadata.title }}</a>
  </div>
  <button id="mobile-nav-toggle" aria-expanded="false" aria-controls="mobile-menu" class="mobile-navigation-trigger flex-1/2 p-2 -mr-2 w-full text-right">
    <span class="sr-only">Menu</span>
    <div class="relative h-6 overflow-hidden">
      <span class="menu-text block">Menu</span>
      <span class="close-text absolute top-0 right-0 translate-y-6">Close</span>
    </div>
  </button>
</nav>

{#- Mobile Menu Panel -#}
<div id="mobile-menu" class="menu-withclock hidden fixed inset-0 z-40 text-black bg-stone-300 translate-y-full lg:hidden will-change-transform" aria-hidden="true">
  <div class="pt-24 h-full overflow-y-auto">
    <ul class="pb-20" aria-label="Mobile Navigation Links">
      {#- Main Nav Links -#}
      {% for item in navLinks %}
        <li class="border-b border-black">
          <a href="{{ item.path }}"{% if item.target %} target="{{ item.target }}" rel="noopener noreferrer"{% endif %} class="block py-4 px-4 text-lg hover:bg-stone-600/10 transition-colors duration-200" onclick="document.getElementById('mobile-menu').classList.remove('!translate-y-0')">
            {{ item.title }}
          </a>
        </li>
      {% endfor %}
      
      {#- Let's Meet Link -#}
      <li class="border-b border-black border-dashed">
        <a href="{{ letsMeetLink.path }}" target="_blank" rel="noopener noreferrer" class="block py-4 px-4 text-lg hover:bg-stone-600/10 transition-colors duration-200">
          {{ letsMeetLink.title }}
        </a>
      </li>
      
      {#- Software and Design -#}
      <li class="border-b border-black border-dashed">
        <div class="block py-4 px-4 text-lg hover:bg-stone-600/10 transition-colors duration-200">
          <span>Software and Design</span>
        </div>
      </li>
    </ul>

    {#- Mobile Footer Social Links -#}
    <div class="fixed px-4 bottom-0 left-0 w-full bg-stone-400/90 backdrop-blur-sm flex justify-between items-center py-4 border-t border-black">
      {% for link in socialLinks %}
        <a href="{{ link.path }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-sm hover:opacity-80 transition-opacity" aria-label="{{ link.title }} (opens in a new tab)">
          <span>{{ link.title }}</span>
        </a>
      {% endfor %}
    </div>
  </div>
</div>

{#- Desktop Navigation -#}
<nav aria-label="Primary Navigation" class="menu-withclock hidden lg:block w-full text-red pt-4 px-4 text-lg header-blend-mode bg-clip-text bg-transparent text-[var(--color-stone-400-inverted)] fixed top-0 z-50">
  <div class="flex justify-between items-center lg:container mx-auto">
    <div class="font-bold font-queens text-xl">
      <a href="/" class="before:bg-[var(--color-stone-400-inverted)] dynamic-underline-left" aria-label="The Other Dev Home">{{ metadata.title }}</a>
    </div>

    <div>
      <p class="font-twk">Software and Design</p>
    </div>

    {#- Main Desktop Links -#}
    <ul class="flex gap-6 font-twk">
      {% for item in navLinks %}
        <li>
          <a href="{{ item.path }}"{% if item.target %} target="{{ item.target }}" rel="noopener noreferrer"{% endif %} class="before:bg-[var(--color-stone-400-inverted)] dynamic-underline-left hover:opacity-75 transition-all"{% if item.path == page.url %} aria-current="page"{% endif %}>
            {{ item.title }}
          </a>
        </li>
      {% endfor %}
    </ul>

    {#- Desktop Right-Side Links (Action & Social) -#}
    <ul class="flex gap-4 items-center font-twk">
      <li>
        <a href="{{ letsMeetLink.path }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-sm hover:opacity-80 transition-opacity" aria-label="{{ letsMeetLink.title }} (opens in a new tab)">
          <span class="font-medium">{{ letsMeetLink.title }}</span>
        </a>
      </li>
      {% for link in socialLinks %}
        <li>
          <a href="{{ link.path }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-sm hover:opacity-80 transition-opacity" aria-label="{{ link.title }} (opens in a new tab)">
            <span class="font-medium">{{ link.title }}</span>
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
</nav>

{#- Navigation Styles -#}
<style>
  .header-blend-mode {
    mix-blend-mode: difference;  
    will-change: transform; 
    isolation: isolate; 
  }
  
  /* Dynamic underlines now handled in global CSS */
  
  .font-queens {
    font-family: var(--font-family-heading);
  }
  
  .font-twk {
    font-family: var(--font-family);
  }
  
  /* Mobile menu transitions */
  #mobile-menu {
    transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }
  
  #mobile-menu.active {
    transform: translateY(0);
  }
  
  /* Mobile navigation text animation */
  .mobile-navigation-trigger .menu-text,
  .mobile-navigation-trigger .close-text {
    transition: transform 0.3s ease;
  }
  
  .mobile-navigation-trigger[aria-expanded="true"] .menu-text {
    transform: translateY(-24px);
  }
  
  .mobile-navigation-trigger[aria-expanded="true"] .close-text {
    transform: translateY(0);
  }
</style>

{#- Navigation Scripts -#}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const menuButton = document.getElementById('mobile-nav-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (menuButton && mobileMenu) {
    mobileMenu.classList.remove('hidden');
    
    menuButton.addEventListener('click', function() {
      const isOpen = menuButton.getAttribute('aria-expanded') === 'true';
      
      // Toggle menu visibility
      if (isOpen) {
        mobileMenu.style.transform = 'translateY(100%)';
      } else {
        mobileMenu.style.transform = 'translateY(0%)';
      }
      
      // Update accessibility attributes
      menuButton.setAttribute('aria-expanded', !isOpen);
      mobileMenu.setAttribute('aria-hidden', isOpen);
    });
    
    // Close menu when clicking on links
    const menuLinks = mobileMenu.querySelectorAll('a');
    menuLinks.forEach(link => {
      link.addEventListener('click', function() {
        mobileMenu.style.transform = 'translateY(100%)';
        menuButton.setAttribute('aria-expanded', 'false');
        mobileMenu.setAttribute('aria-hidden', 'true');
      });
    });
    
    // Set initial position
    mobileMenu.style.transform = 'translateY(100%)';
  }
  
  // Handle mobile menu body scroll lock
  const body = document.body;
  if (menuButton && mobileMenu) {
    menuButton.addEventListener('click', function() {
      const isOpen = menuButton.getAttribute('aria-expanded') === 'true';
      if (!isOpen) {
        body.style.overflow = 'hidden';
      } else {
        body.style.overflow = '';
      }
    });
  }
});
</script>